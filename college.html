<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Image Collage</title>
<style>
    #collage-container {
        width: 600px;
        height: 400px;
        border: 1px solid #ccc;
        position: relative;
        margin: 0 auto;
        overflow: hidden;
    }

    .draggable {
        position: absolute;
        cursor: move;
    }

    .delete-btn {
        position: absolute;
        top: 5px;
        right: 5px;
        background-color: rgba(255, 0, 0, 0.5);
        color: white;
        border: none;
        border-radius: 50%;
        width: 20px;
        height: 20px;
        line-height: 20px;
        text-align: center;
        cursor: pointer;
        display: none;
    }

    .draggable.selected .delete-btn {
        display: block;
    }

    #save-btn {
        display: block;
        margin: 20px auto;
        padding: 10px 20px;
        background-color: #007bff;
        color: #fff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }
</style>
</head>
<body>
    <input type="file" id="file-input" multiple>
    <button id="save-btn">Save Collage</button>
    <div id="collage-container">
        <!-- Images will be added here -->
    </div>

<script>
    // Function to handle file input change
    document.getElementById('file-input').addEventListener('change', function(e) {
        const files = e.target.files;
        const collageContainer = document.getElementById('collage-container');

        for (let i = 0; i < files.length; i++) {
            const file = files[i];
            const reader = new FileReader();

            reader.onload = function(e) {
                const img = new Image();
                img.src = e.target.result;
                img.className = 'draggable';
                img.style.position = 'absolute';
                img.style.top = '50px';
                img.style.left = '50px';
                collageContainer.appendChild(img);

                makeDraggable(img);
            }

            reader.readAsDataURL(file);
        }
    });

    // Function to make images draggable
    function makeDraggable(element) {
        element.addEventListener('mousedown', function(e) {
            let offsetX = e.clientX - element.getBoundingClientRect().left;
            let offsetY = e.clientY - element.getBoundingClientRect().top;

            function move(e) {
                element.style.left = (e.clientX - offsetX) + 'px';
                element.style.top = (e.clientY - offsetY) + 'px';
            }

            function stopMove() {
                document.removeEventListener('mousemove', move);
                document.removeEventListener('mouseup', stopMove);
            }

            document.addEventListener('mousemove', move);
            document.addEventListener('mouseup', stopMove);
        });

        element.addEventListener('click', function(e) {
            element.classList.toggle('selected');
            e.stopPropagation();
        });

        const deleteBtn = document.createElement('button');
        deleteBtn.className = 'delete-btn';
        deleteBtn.innerText = 'X';
        deleteBtn.addEventListener('click', function(e) {
            element.remove();
            e.stopPropagation();
        });
        element.appendChild(deleteBtn);
    }

    // Function to save collage as a single image
    document.getElementById('save-btn').addEventListener('click', function() {
        const collageContainer = document.getElementById('collage-container');
        const canvas = document.createElement('canvas');
        canvas.width = collageContainer.offsetWidth;
        canvas.height = collageContainer.offsetHeight;
        const ctx = canvas.getContext('2d');

        // Draw images onto canvas
        const images = collageContainer.querySelectorAll('.draggable');
        images.forEach(img => {
            ctx.drawImage(img, parseInt(img.style.left), parseInt(img.style.top), img.width, img.height);
        });

        // Convert canvas to data URL and open in new tab
        const dataURL = canvas.toDataURL();
        const link = document.createElement('a');
        link.href = dataURL;
        link.download = 'collage.png';
        link.click();
    });
</script>
</body>
</html>
